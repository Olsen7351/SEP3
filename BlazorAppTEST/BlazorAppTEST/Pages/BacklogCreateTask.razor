@using Xunit.Sdk
@using BlazorAppTEST.Services
@page "/BacklogCreateTask/{ProjectID}"
@inject ProjectService ProjectService


<h3>BacklogCreateTask</h3>

<div class="task-container">
    <h3>Create Task</h3>
    <label for="description">Description</label>
    <input type="text" id="description" @bind="Description"/>
    <button @onclick="CreateTask">Create Task</button>
    
     <label for="entryDate">Entry Date</label>
        <input type="date" id="entryDate" @bind="EntryDate" />
    
        <label for="hoursWorked">Hours Worked</label>
        <input type="number" id="hoursWorked" @bind="HoursWorked" />
    
        <button @onclick="CreateTask">Create Task</button>
        <button @onclick="CreateTimeEntry">Create Time Entry</button>
</div>




@code {
    
    //Task Description
    string Description { get; set; }
    DateTime EntryDate { get; set; } // Ny egenskab for Entry Date
    double HoursWorked { get; set; } // Ny egenskab for Hours Worked
    //Current ProjectID
    [Parameter]
    public string ProjectID { get; set; }
    //Projects Backlog
    private string backlogID;

    
    
    
    //Get current BacklogID
    protected override async Task OnInitializedAsync()
    {
        backlogID = await ProjectService.GetBacklogIDForProject(ProjectID); // <-- Don't re-declare the variable, just assign.
    }

    private void CreateTask()
    {
        var task = new
        {
            ProjectID = this.ProjectID,
            BacklogID = this.backlogID, 
            Description = this.Description
        };

        if (string.IsNullOrEmpty(Description))
        {
            throw new Exception("Can't submit an empty string");
        }
        else
        {
            
            
        }
    }
    private void CreateTimeEntry()
    {
        if (EntryDate == DateTime.MinValue || HoursWorked <= 0)
        {
            throw new Exception("Invalid time entry data");
        }

    // Opret en tidsregistrering (TaskTimeEntry)
        var timeEntry = new
        {
            EntryDate = this.EntryDate,
            HoursWorked = this.HoursWorked
        };

    // Tilføj tidsregistreringen til din opgave (brug ProjectService eller anden metode)
    }
}
